<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<html>
<head></head>
<body>
	<!--
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ SimplestPiano [0.1.0] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                                SimplestPiano by I.A.

        SimplestPiano is the simplest piano simulator in HTML/JS you can ever
    made. That is not totallly accurate because of the term "simplest" that is
    not very explicit...

        Let's just say that this is the simplest piano simulator you can ever
    do with a standard JS code, clear, clean, readable & commented.

    24/07/2019 > [0.1.0] :
    - Created PianoSimulator.html & sound files from C4 to C5.

    BUGS : .
    NOTES : .

    Contact     : i.a.sebsil83@gmail.com
    Youtube     : https://www.youtube.com/user/IAsebsil83
    GitHub repo : https://github.com/iasebsil83

    Let's Code !                                  By I.A.
*********************************************************************************
    LICENCE :
    SimplestPiano
    Copyright (C) 2019  Sebastien SILVANO
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program.
    If not, see <https://www.gnu.org/licenses/>.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<!-- sound elements -->
	<audio id="a_C4" controls autoplay hidden>
		<source id="C4" src="sounds/C4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_Cd4" controls autoplay hidden>
		<source id="Cd4" src="sounds/Cd4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_D4" controls autoplay hidden>
		<source id="D4" src="sounds/D4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_Dd4" controls autoplay hidden>
		<source id="Dd4" src="sounds/Dd4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_E4" controls autoplay hidden>
		<source id="E4" src="sounds/E4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_F4" controls autoplay hidden>
		<source id="F4" src="sounds/F4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_Fd4" controls autoplay hidden>
		<source id="Fd4" src="sounds/Fd4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_G4" controls autoplay hidden>
		<source id="G4" src="sounds/G4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_Gd4" controls autoplay hidden>
		<source id="Gd4" src="sounds/Gd4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_A4" controls autoplay hidden>
		<source id="A4" src="sounds/A4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_Ad4" controls autoplay hidden>
		<source id="Ad4" src="sounds/Ad4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_B4" controls autoplay hidden>
		<source id="B4" src="sounds/B4.mp3" type="audio/mpeg"></source>
	</audio>
	<audio id="a_C5" controls autoplay hidden>
		<source id="C5" src="sounds/C5.mp3" type="audio/mpeg"></source>
	</audio>

	<!-- graphics -->
	<canvas id="c" width="600" height="300"></canvas>

	<!-- code -->
	<script language="javascript">

//functional vars
var c = document.getElementById("c");
var d = c.getContext("2d");
var noteReleased = [true,true,true,true,true,true,true,true,true,true,true,true,true]; //for each note
var chord = false;
var minor = false;
var s7 = false;

//sound
function playSound(name){
    document.getElementById("a_" + name).load();
}

//keypad events
document.addEventListener('keydown',function(e){
	switch(e.keyCode){
		//normals
		case 81: //q <=> C4
			if(noteReleased[0]){
				if(chord){
					if(!minor){

						//C M chord
						playSound("C4");
						noteReleased[0] = false;
						playSound("E4");
						noteReleased[4] = false;
						playSound("G4");
						noteReleased[7] = false;
					}else{

						//C m chord
						playSound("C4");
						noteReleased[0] = false;
						playSound("Dd4");
						noteReleased[3] = false;
						playSound("G4");
						noteReleased[7] = false;
					}
				}else{
					playSound("C4");
					noteReleased[0] = false;
				}
			}
		break;
		case 83: //s <=> D4
			if(noteReleased[2]){
				if(chord){
					if(!minor){

						//D M chord
						playSound("D4");
						noteReleased[2] = false;
						playSound("Fd4");
						noteReleased[6] = false;
						playSound("A4");
						noteReleased[9] = false;
					}else{

						//D m chord
						playSound("D4");
						noteReleased[2] = false;
						playSound("F4");
						noteReleased[5] = false;
						playSound("A4");
						noteReleased[9] = false;
					}
				}else{
					playSound("D4");
					noteReleased[2] = false;
				}
			}
		break;
		case 68: //d <=> E4
			if(noteReleased[4]){
				if(chord){
					if(!minor){

						//E M chord
						playSound("E4");
						noteReleased[4] = false;
						playSound("Gd4");
						noteReleased[8] = false;
						playSound("B4");
						noteReleased[11] = false;
					}else{

						//E m chord
						playSound("E4");
						noteReleased[4] = false;
						playSound("G4");
						noteReleased[7] = false;
						playSound("B4");
						noteReleased[11] = false;
					}
				}else{
					playSound("E4");
					noteReleased[4] = false;
				}
			}
		break;
		case 70: //f <=> F4
			if(noteReleased[5]){
				if(chord){
					if(!minor){

						//F M chord
						playSound("F4");
						noteReleased[5] = false;
						playSound("A4");
						noteReleased[9] = false;
						playSound("C5");
						noteReleased[12] = false;
					}else{

						//F m chord
						playSound("F4");
						noteReleased[5] = false;
						playSound("Gd4");
						noteReleased[8] = false;
						playSound("C5");
						noteReleased[12] = false;
					}
				}else{
					playSound("F4");
					noteReleased[5] = false;
				}
			}
		break;
		case 71: //g <=> G4
			if(noteReleased[7]){
				if(chord){
					if(!minor){

						//G M chord
						playSound("G4");
						noteReleased[7] = false;
						playSound("B4");
						noteReleased[11] = false;
						playSound("D4");
						noteReleased[2] = false;
					}else{

						//G m chord
						playSound("G4");
						noteReleased[7] = false;
						playSound("Ad4");
						noteReleased[10] = false;
						playSound("D4");
						noteReleased[2] = false;
					}
				}else{
					playSound("G4");
					noteReleased[7] = false;
				}
			}
		break;
		case 72: //h <=> A4
			if(noteReleased[9]){
				if(chord){
					if(!minor){

						//A M chord
						playSound("A4");
						noteReleased[9] = false;
						playSound("Cd4");
						noteReleased[1] = false;
						playSound("E4");
						noteReleased[4] = false;
					}else{

						//A m chord
						playSound("A4");
						noteReleased[9] = false;
						playSound("C4");
						noteReleased[0] = false;
						playSound("E4");
						noteReleased[4] = false;
					}
				}else{
					playSound("A4");
					noteReleased[9] = false;
				}
			}
		break;
		case 74: //j <=> B4
			if(noteReleased[11]){
				if(chord){
					if(!minor){

						//B M chord
						playSound("B4");
						noteReleased[11] = false;
						playSound("Dd4");
						noteReleased[3] = false;
						playSound("Fd4");
						noteReleased[6] = false;
					}else{

						//B m chord
						playSound("B4");
						noteReleased[11] = false;
						playSound("D4");
						noteReleased[2] = false;
						playSound("Fd4");
						noteReleased[6] = false;
					}
				}else{
					playSound("B4");
					noteReleased[11] = false;
				}
			}
		break;
		case 75: //k <=> C5
			if(noteReleased[12]){
				if(chord){
					if(!minor){

						//C M chord
						playSound("C5");
						noteReleased[12] = false;
						playSound("E4");
						noteReleased[4] = false;
						playSound("G4");
						noteReleased[7] = false;
					}else{

						//C m chord
						playSound("C5");
						noteReleased[12] = false;
						playSound("Dd4");
						noteReleased[3] = false;
						playSound("G4");
						noteReleased[7] = false;
					}
				}else{
					playSound("C5");
					noteReleased[12] = false;
				}
			}
		break;
		//altered
		case 90: //z <=> Cd4
			if(noteReleased[1]){
				if(chord){
					if(!minor){

						//Cd M chord
						playSound("Cd4");
						noteReleased[1] = false;
						playSound("F4");
						noteReleased[5] = false;
						playSound("Gd4");
						noteReleased[8] = false;
					}else{

						//Cd m chord
						playSound("Cd4");
						noteReleased[1] = false;
						playSound("E4");
						noteReleased[4] = false;
						playSound("Gd4");
						noteReleased[8] = false;
					}
				}else{
					playSound("Cd4");
					noteReleased[1] = false;
				}
			}
		break;
		case 69: //e <=> Dd4
			if(noteReleased[3]){
				if(chord){
					if(!minor){

						//Dd M chord
						playSound("Dd4");
						noteReleased[3] = false;
						playSound("G4");
						noteReleased[7] = false;
						playSound("Ad4");
						noteReleased[10] = false;
					}else{

						//Dd m chord
						playSound("Dd4");
						noteReleased[3] = false;
						playSound("Fd4");
						noteReleased[6] = false;
						playSound("Ad4");
						noteReleased[10] = false;
					}
				}else{
					playSound("Dd4");
					noteReleased[3] = false;
				}
			}
		break;
		case 84: //t <=> Fd4
			if(noteReleased[6]){
				if(chord){
					if(!minor){

						//Fd M chord
						playSound("Fd4");
						noteReleased[6] = false;
						playSound("Ad4");
						noteReleased[10] = false;
						playSound("Cd4");
						noteReleased[1] = false;
					}else{

						//Fd m chord
						playSound("Fd4");
						noteReleased[6] = false;
						playSound("A4");
						noteReleased[9] = false;
						playSound("Cd4");
						noteReleased[1] = false;
					}
				}else{
					playSound("Fd4");
					noteReleased[6] = false;
				}
			}
		break;
		case 89: //y <=> Gd4
			if(noteReleased[8]){
				if(chord){
					if(!minor){

						//Gd M chord
						playSound("Gd4");
						noteReleased[8] = false;
						playSound("C4");
						noteReleased[0] = false;
						playSound("Dd4");
						noteReleased[3] = false;
					}else{

						//Gd m chord
						playSound("Gd4");
						noteReleased[8] = false;
						playSound("B4");
						noteReleased[11] = false;
						playSound("Dd4");
						noteReleased[3] = false;
					}
				}else{
					playSound("Gd4");
					noteReleased[8] = false;
				}
			}
		break;
		case 85: //u <=> Ad4
			if(noteReleased[10]){
				if(chord){
					if(!minor){

						//Ad M chord
						playSound("Ad4");
						noteReleased[10] = false;
						playSound("D4");
						noteReleased[2] = false;
						playSound("F4");
						noteReleased[5] = false;
					}else{

						//Ad m chord
						playSound("Ad4");
						noteReleased[10] = false;
						playSound("Cd4");
						noteReleased[1] = false;
						playSound("F4");
						noteReleased[5] = false;
					}
				}else{
					playSound("Ad4");
					noteReleased[10] = false;
				}
			}
		break;

		//chord
		case 32: //space <=> chord
			chord = true;
		break;

		//minor
		case 16: //shift <=> minor
			minor = true;
		break;
	}
});

document.addEventListener('keyup',function(e){
	switch(e.keyCode){

		//normals
		case 81: //q <=> C4
			if(chord){
				if(!minor){

					//C M chord
					noteReleased[0] = true;
					noteReleased[4] = true;
					noteReleased[7] = true;
				}else{

					//C m chord
					noteReleased[0] = true;
					noteReleased[3] = true;
					noteReleased[7] = true;
				}
			}else
				noteReleased[0] = true;
		break;
		case 83: //s <=> D4
			if(chord){
				if(!minor){

					//D M chord
					noteReleased[2] = true;
					noteReleased[6] = true;
					noteReleased[9] = true;
				}else{

					//D m chord
					noteReleased[2] = true;
					noteReleased[5] = true;
					noteReleased[9] = true;
				}
			}else
				noteReleased[2] = true;
		break;
		case 68: //d <=> E4
			if(chord){
				if(!minor){

					//E M chord
					noteReleased[4] = true;
					noteReleased[8] = true;
					noteReleased[11] = true;
				}else{

					//E m chord
					noteReleased[4] = true;
					noteReleased[7] = true;
					noteReleased[11] = true;
				}
			}else
				noteReleased[4] = true;
		break;
		case 70: //f <=> F4
			if(chord){
				if(!minor){

					//F M chord
					noteReleased[5] = true;
					noteReleased[9] = true;
					noteReleased[12] = true;
				}else{

					//F m chord
					noteReleased[5] = true;
					noteReleased[8] = true;
					noteReleased[12] = true;
				}
			}else
				noteReleased[5] = true;
		break;
		case 71: //g <=> G4
			if(chord){
				if(!minor){

					//G M chord
					noteReleased[7] = true;
					noteReleased[11] = true;
					noteReleased[2] = true;
				}else{

					//G m chord
					noteReleased[7] = true;
					noteReleased[10] = true;
					noteReleased[2] = true;
				}
			}else
				noteReleased[7] = true;
		break;
		case 72: //h <=> A4
			if(chord){
				if(!minor){

					//A M chord
					noteReleased[9] = true;
					noteReleased[1] = true;
					noteReleased[4] = true;
				}else{

					//A m chord
					noteReleased[9] = true;
					noteReleased[0] = true;
					noteReleased[4] = true;
				}
			}else
				noteReleased[9] = true;
		break;
		case 74: //j <=> B4
			if(chord){
				if(!minor){

					//B M chord
					noteReleased[11] = true;
					noteReleased[3] = true;
					noteReleased[6] = true;
				}else{

					//B m chord
					noteReleased[11] = true;
					noteReleased[2] = true;
					noteReleased[6] = true;
				}
			}else
				noteReleased[11] = true;
		break;
		case 75: //k <=> C5
			if(chord){
				if(!minor){

					//C M chord
					noteReleased[12] = true;
					noteReleased[4] = true;
					noteReleased[7] = true;
				}else{

					//C m chord
					noteReleased[12] = true;
					noteReleased[3] = true;
					noteReleased[7] = true;
				}
			}else
				noteReleased[12] = true;
		break;
		//altered
		case 90: //z <=> Cd4
			if(chord){
				if(!minor){

					//Cd M chord
					noteReleased[1] = true;
					noteReleased[5] = true;
					noteReleased[8] = true;
				}else{

					//Cd m chord
					noteReleased[1] = true;
					noteReleased[4] = true;
					noteReleased[8] = true;
				}
			}else
				noteReleased[1] = true;
		break;
		case 69: //e <=> Dd4
			if(chord){
				if(!minor){

					//Dd M chord
					noteReleased[3] = true;
					noteReleased[7] = true;
					noteReleased[10] = true;
				}else{

					//Dd m chord
					noteReleased[3] = true;
					noteReleased[6] = true;
					noteReleased[10] = true;
				}
			}else
				noteReleased[3] = true;
		break;
		case 84: //t <=> Fd4
			if(chord){
				if(!minor){

					//Fd M chord
					noteReleased[6] = true;
					noteReleased[10] = true;
					noteReleased[1] = true;
				}else{

					//Fd m chord
					noteReleased[6] = true;
					noteReleased[9] = true;
					noteReleased[1] = true;
				}
			}else
				noteReleased[6] = true;
		break;
		case 89: //y <=> Gd4
			if(chord){
				if(!minor){

					//Gd M chord
					noteReleased[8] = true;
					noteReleased[0] = true;
					noteReleased[3] = true;
				}else{

					//Gd m chord
					noteReleased[8] = true;
					noteReleased[11] = true;
					noteReleased[3] = true;
				}
			}else
				noteReleased[8] = true;
		break;
		case 85: //u <=> Ad4
			if(chord){
				if(!minor){

					//Ad M chord
					noteReleased[10] = true;
					noteReleased[2] = true;
					noteReleased[5] = true;
				}else{

					//Ad m chord
					noteReleased[10] = true;
					noteReleased[1] = true;
					noteReleased[5] = true;
				}
			}else
				noteReleased[10] = true;
		break;

		//chord
		case 32: //space <=> chord
			chord = false;
		break;

		//minor
		case 16: //shift <=> minor
			minor = false;
		break;
	}
});

//graphics
setInterval(drawPiano,10);
function drawPiano(){

	//background
	d.fillStyle = 'rgba(255,150,0,1)';
	d.fillRect(0,0,600,300);

	//white keys
	d.fillStyle = 'rgba(255,255,255,1)';
	for(var x=0; x < 8; x++)
		d.fillRect(100+x*50,150,45,100);

	//blue on white keys
	d.fillStyle = 'rgba(0,0,255,1)';
	for(var a=0; a < 13; a++){
		if(!noteReleased[a]){
			switch(a){
				//normals
				case 0:
					d.fillRect(100,150,45,100);
				break;
				case 2:
					d.fillRect(150,150,45,100);
				break;
				case 4:
					d.fillRect(200,150,45,100);
				break;
				case 5:
					d.fillRect(250,150,45,100);
				break;
				case 7:
					d.fillRect(300,150,45,100);
				break;
				case 9:
					d.fillRect(350,150,45,100);
				break;
				case 11:
					d.fillRect(400,150,45,100);
				break;
				case 12:
					d.fillRect(450,150,45,100);
				break;
			}
		}
	}

	//black keys
	d.fillStyle = 'rgba(0,0,0,1)';
	for(var x=0; x < 6; x++)
		if(x != 2)
			d.fillRect(125+x*50,100,45,100);

	//blue on black keys
	d.fillStyle = 'rgba(0,0,255,1)';
	for(var a=0; a < 13; a++){
		if(!noteReleased[a]){
			switch(a){
				//altered
				case 1:
					d.fillRect(125,100,45,100);
				break;
				case 3:
					d.fillRect(175,100,45,100);
				break;
				case 6:
					d.fillRect(275,100,45,100);
				break;
				case 8:
					d.fillRect(325,100,45,100);
				break;
				case 10:
					d.fillRect(375,100,45,100);
				break;
			}
		}
	}
}

 </script>
</body>
</html>
